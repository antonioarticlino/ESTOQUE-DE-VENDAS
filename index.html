<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Estoque de Pe√ßas de Computador</title>

  <style>
    :root {
      --primary: #3b82f6;
      --secondary: #22d3ee;
      --text: #e5e7eb;
      --success: #22c55e;
      --danger: #ef4444;
    }

    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: radial-gradient(circle at top, #111827, #020617);
      margin: 0;
      padding: 12px;
      color: var(--text);
    }

    h1 {
      text-align: center;
      color: var(--secondary);
      margin-bottom: 10px;
      letter-spacing: 1px;
    }

    .container {
      max-width: 1100px;
      margin: auto;
      background: linear-gradient(180deg, #0f172a, #020617);
      padding: 18px;
      border-radius: 14px;
      box-shadow: 0 0 30px rgba(59,130,246,0.15);
      border: 1px solid rgba(59,130,246,0.2);
    }

    input, select, button {
      padding: 10px;
      font-size: 14px;
      border-radius: 8px;
      border: 1px solid rgba(59,130,246,0.3);
      background: #020617;
      color: var(--text);
    }

    button {
      cursor: pointer;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: #020617;
      font-weight: bold;
      border: none;
    }

    .filtros, form {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
    }

    th {
      background: rgba(59,130,246,0.15);
      color: var(--secondary);
      padding: 10px;
    }

    td {
      padding: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      text-align: center;
    }

    .vendido { color: var(--danger); font-weight: bold; }
    .nao-vendido { color: var(--success); font-weight: bold; }

    .btn-remover {
      background: linear-gradient(135deg, #ef4444, #b91c1c);
      color: #fff;
      margin-left: 4px;
    }

    @media (max-width: 600px) {
      table, thead, tbody, th, td, tr { display: block; }
      thead { display: none; }
      tr {
        background: #020617;
        margin-bottom: 12px;
        border-radius: 12px;
        padding: 10px;
      }
      button { width: 100%; margin-top: 6px; }
      td { text-align: left; }
    }
  </style>
</head>

<body>

<div class="container">
  <h1>Controle de Estoque - Pe√ßas de Computador</h1>

  <div class="filtros">
    <input type="text" id="pesquisa" placeholder="Pesquisar por nome" style="flex:1">
    <select id="filtroCategoria">
      <option value="Todas">Todas as categorias</option>
      <option>Placa-m√£e</option>
      <option>Processador</option>
      <option>Mem√≥ria RAM</option>
      <option>Armazenamento</option>
      <option>Placa de v√≠deo</option>
      <option>Outros</option>
    </select>
  </div>

  <form id="formProduto">
    <input type="text" id="nome" placeholder="Nome do produto" required>
    <select id="categoria" required>
      <option value="">Selecione a categoria</option>
      <option>Placa-m√£e</option>
      <option>Processador</option>
      <option>Mem√≥ria RAM</option>
      <option>Armazenamento</option>
      <option>Placa de v√≠deo</option>
      <option>Outros</option>
    </select>
    <button type="submit">Adicionar Produto</button>
  </form>

  <table>
    <thead>
      <tr>
        <th>Produto</th>
        <th>Categoria</th>
        <th>Status</th>
        <th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody id="listaProdutos"></tbody>
  </table>
</div>

<!-- FIREBASE -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getFirestore, collection, addDoc, getDocs,
    deleteDoc, doc, updateDoc
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // üî¥ COLE SEU firebaseConfig AQUI
  const firebaseConfig = {
    apiKey: "AIzaSyDtmu5yKt5Kz8yxzTCCf5MfC2av1O5zL2Q",
    authDomain: "lojavendas-ae418.firebaseapp.com",
    projectId: "lojavendas-ae418",
    storageBucket: "lojavendas-ae418.firebasestorage.app",
    messagingSenderId: "241091939383",
    appId: "1:241091939383:web:b676e35c3c8c7c45c183b2"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const form = document.getElementById("formProduto");
  const lista = document.getElementById("listaProdutos");
  const pesquisa = document.getElementById("pesquisa");
  const filtroCategoria = document.getElementById("filtroCategoria");

  async function renderizar() {
    lista.innerHTML = "";
    const termo = pesquisa.value.toLowerCase();
    const categoriaFiltro = filtroCategoria.value;

    const snapshot = await getDocs(collection(db, "produtos"));

    snapshot.forEach(docSnap => {
      const p = docSnap.data();
      const id = docSnap.id;

      if (
        (termo && !p.nome.toLowerCase().includes(termo)) ||
        (categoriaFiltro !== "Todas" && p.categoria !== categoriaFiltro)
      ) return;

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${p.nome}</td>
        <td>${p.categoria}</td>
        <td class="${p.vendido ? 'vendido' : 'nao-vendido'}">
          ${p.vendido ? 'Vendido' : 'Dispon√≠vel'}
        </td>
        <td>
          <button onclick="alternarStatus('${id}', ${p.vendido})">
            Alternar status
          </button>
          <button class="btn-remover" onclick="removerProduto('${id}')">
            Remover
          </button>
        </td>
      `;
      lista.appendChild(tr);
    });
  }

  form.addEventListener("submit", async e => {
    e.preventDefault();
    await addDoc(collection(db, "produtos"), {
      nome: nome.value,
      categoria: categoria.value,
      vendido: false
    });
    form.reset();
    renderizar();
  });

  window.alternarStatus = async (id, status) => {
    await updateDoc(doc(db, "produtos", id), { vendido: !status });
    renderizar();
  };

  window.removerProduto = async id => {
    await deleteDoc(doc(db, "produtos", id));
    renderizar();
  };

  pesquisa.addEventListener("input", renderizar);
  filtroCategoria.addEventListener("change", renderizar);

  renderizar();
</script>

</body>
</html>
